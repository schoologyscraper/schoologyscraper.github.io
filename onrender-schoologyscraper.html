<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Unofficial site with class of 2029's photos">
    <meta name="author" content="CC">
    <meta name="keywords" content="FUHSD, Fremont Union High School District, FHS, Fremont High School, Homestead High School, HHS, Cupertino High School, CHS, Lynbrook High School, LHS, Photo, Photos, Yearbook, Schoology">
    <title>Schoology scraper</title>
    <style>
      body {
        margin: 0;
        background-color: #f5f5f5;
      }
      .hidden {
        display: none !important;
      }
      .center {
        text-align: center;
      }
      .searchbar {
        position: sticky;
        top: 0;
        left: 0;
        padding: 10px 10px 20px 10px;
        width: calc(100% - 20px);
        font-size: 20px;
      }
      .searchbar .background-blur {
        position: absolute;
        top: 0;
        left: 0;
        z-index: -1;
        mask: linear-gradient(black, black, black, transparent);
        backdrop-filter: blur(10px);
        width: 100%;
        height: calc(100% + 10px);
      }
      .searchbar input {
        flex: 1;
        border: 0;
        padding: 5px 10px;
        outline: none;
        font-size: 15px;
      }
      .searchbar .searchbar-input {
        background-color: #fff;
      	border: 1px solid #999999;
        width: 100%;
        display: flex;
        border-radius: 1000px;
      }
      #searchresults {
        text-align: center;
      }
      .person {
        display: inline-block;
        padding: 10px;
        text-align: center;
        cursor: pointer;
        border-radius: 10px;
        margin: 10px;
        width: 200px;
        transition: 0.3s;
      }
      .person:hover {
        background-color: #dfdfdf;
        transition: 0.3s;
      }
      .person img {
        height: 160px;
        max-width: 200px;
      }
      .person p {
        margin: 0;
      	display: block;
      }
      
      .searchbar-icon {
      	background-color: #ffffff;
        border: 0;
        outline: 0;
        border-radius: 1000px;
        padding: 5px;
        width: 30px;
        height: 30px;
        margin: 0;
        transition: 0.5s;
      }
      .searchbar-icon:hover {
      	background-color: #eeeeee;
        transition: 0.5s;
      }
      #filter-menu {
        background-color: #f5f5f5;
        padding: 30px;
      }
    </style>
  </head>
  <body>
    <div class="searchbar">
      <div class="background-blur"></div>
      <div class="searchbar-input">
        <button class="searchbar-icon" id="search-btn">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.49,19l-5.73-5.73C15.53,12.2,16,10.91,16,9.5C16,5.91,13.09,3,9.5,3S3,5.91,3,9.5C3,13.09,5.91,16,9.5,16 c1.41,0,2.7-0.47,3.77-1.24L19,20.49L20.49,19z M5,9.5C5,7.01,7.01,5,9.5,5S14,7.01,14,9.5S11.99,14,9.5,14S5,11.99,5,9.5z"></path><path d="M0,0h24v24H0V0z" fill="none"></path></svg>
        </button>
        <input id="searchbar-input" placeholder="Search...">
        <button class="searchbar-icon" id="filter-btn">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 17v2h6v-2H3zM3 5v2h10V5H3zm10 16v-2h8v-2h-8v-2h-2v6h2zM7 9v2H3v2h4v2h2V9H7zm14 4v-2H11v2h10zm-6-4h2V7h4V5h-4V3h-2v6z"></path></svg>
        </button>
      </div>
    </div>
    <div id="searchresults">
      <div class="center"><p>Database taken from <a href="https://schoologyscraper.onrender.com/">https://schoologyscraper.onrender.com</a> (this is not mine)</p></div>
      <div id="app"></div>
      <div id="appEnd"></div>
    </div>
    <div id="filter-menu" class="hidden">
      <label for="checkbox-mvhs">Monta Vista</label><input id="checkbox-mvhs" type="checkbox" data-school="mvhs" checked><br>
      <label for="checkbox-fhs">Fremont</label><input id="checkbox-fhs" type="checkbox" data-school="fhs" checked><br>
      <label for="checkbox-hhs">Homestead</label><input id="checkbox-hhs" type="checkbox" data-school="hhs" checked><br>
      <label for="checkbox-chs">Cupertino</label><input id="checkbox-chs" type="checkbox" data-school="chs" checked><br>
      <label for="checkbox-lhs">Lynbrook</label><input id="checkbox-lhs" type="checkbox" data-school="lhs" checked><br>
      <hr>
      <label for="checkbox-hasphoto">Has Photo</label><input id="checkbox-hasphoto" type="checkbox" data-hasphoto><br>
    </div>
    
    
    <script>addEventListener("error",(e)=>{alert(e.message)})</script>
    <script>
      let appElement = document.getElementById("app")
      let appEndObserver = document.getElementById("appEnd")
      let searchQueryElement = document.getElementById("searchbar-input")
      let data
      let loadedIndex = 0
      let loadBuffer = 100
      function load() {
        if (data == null) {
          alert("Error: data not loaded yet")
          return
        }
        let currentPeopleLoaded = 0
        let fragment = document.createDocumentFragment()
        while (currentPeopleLoaded < loadBuffer && loadedIndex < data.length) {
          let person = data[loadedIndex]
          let searchMatches = person.name.toLowerCase().includes(searchQueryElement.value.trim().toLowerCase()) || searchQueryElement.value.trim() == ""
          ++loadedIndex
          if (!searchMatches) {
            continue
          }
          let personDiv = document.createElement("div")
          personDiv.classList.add("person")
          personDiv.setAttribute("data-index", loadedIndex-1)
          personDiv.innerHTML = `<img src="${person.image[0]}"></img><p>${person.name}</p>`
          fragment.appendChild(personDiv)
          ++currentPeopleLoaded
        }
        app.appendChild(fragment)
      }
      (async function() {
        try {
          data = (await (await fetch("https://securecentrix81.github.io/schoologyscraper/2025-09-14.json")).json()).students
          load()
          let lastLoadTime = 0
          let observer = new IntersectionObserver(() => {
            if (Date.now() - lastLoadTime < 100) return
            lastLoadTime = Date.now()
            load()
          }, {
            root: null,
            rootMargin: "2000px",
            scrollMargin: "0px",
            threshold: 0.0,
          });
          observer.observe(appEndObserver)
        } catch (e) {
          alert("An error occurred. Details: \n"+e)
        }
      })()
      searchQueryElement.addEventListener("input", (e) => {
        loadedIndex = 0
        appElement.innerHTML = ""
        load()
      })
      app.addEventListener("click", (e) => {
        let dataIndex = e.target.closest("[data-index]")
        if (dataIndex) {
          dataIndex = parseInt(dataIndex.getAttribute("data-index"))
          let jsonData = JSON.parse(data[dataIndex])
          
        }
      })
    </script>
  </body>
</html>
